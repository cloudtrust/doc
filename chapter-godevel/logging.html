
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Logging Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="instrumenting.html" />
    
    
    <link rel="prev" href="testing.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Keycloak Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../chapter-keycloak/sentry.html">
            
                <a href="../chapter-keycloak/sentry.html">
            
                    
                    Sentry integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../chapter-keycloak/storage.html">
            
                <a href="../chapter-keycloak/storage.html">
            
                    
                    Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../chapter-keycloak/protocol.html">
            
                <a href="../chapter-keycloak/protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Deployment
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../chapter-deploy/Introduction.html">
            
                <a href="../chapter-deploy/Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../chapter-deploy/Docker.html">
            
                <a href="../chapter-deploy/Docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../chapter-deploy/Kubernetes.html">
            
                <a href="../chapter-deploy/Kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../chapter-deploy/Systemd_In_Kubernetes.html">
            
                <a href="../chapter-deploy/Systemd_In_Kubernetes.html">
            
                    
                    Systemd In Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../chapter-deploy/Ansible.html">
            
                <a href="../chapter-deploy/Ansible.html">
            
                    
                    Ansible
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../chapter-deploy/Configs.html">
            
                <a href="../chapter-deploy/Configs.html">
            
                    
                    Configurations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../chapter-deploy/Telepresence.html">
            
                <a href="../chapter-deploy/Telepresence.html">
            
                    
                    Telepresence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Go Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="guideline.html">
            
                <a href="guideline.html">
            
                    
                    Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="structure.html">
            
                <a href="structure.html">
            
                    
                    Repository Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="testing.html">
            
                <a href="testing.html">
            
                    
                    Testing with mocks
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.4" data-path="logging.html">
            
                <a href="logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="instrumenting.html">
            
                <a href="instrumenting.html">
            
                    
                    Instrumenting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="tracing.html">
            
                <a href="tracing.html">
            
                    
                    Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="tracking.html">
            
                <a href="tracking.html">
            
                    
                    Tracking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="health_route.html">
            
                <a href="health_route.html">
            
                    
                    Health routes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="debugging.html">
            
                <a href="debugging.html">
            
                    
                    Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="middleware.html">
            
                <a href="middleware.html">
            
                    
                    Middlewares
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Logging</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="logging">Logging</h1>
<p>Cloudtrust has a centralised logging solution using the <a href="https://www.elastic.co/webinars/introduction-elk-stack" target="_blank">Elastic Stack</a>.
To achieve that, the logs are duplicated to Stdout and sent to a <a href="https://redis.io/" target="_blank">Redis</a> server.</p>
<h2 id="standardised-keys">Standardised Keys</h2>
<p>It is essential to have normalised keys, so when can easily search for them in Elasticsearch.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ts</td>
<td>UTC timestamp (use log.DefaultTimestampUTC)</td>
</tr>
<tr>
<td>caller</td>
<td>caller (use log.DefaultCaller)</td>
</tr>
<tr>
<td>component_name</td>
<td>name of the component (e.g. keycloak_bridge)</td>
</tr>
<tr>
<td>component_version</td>
<td>version of the component (e.g. 1.0)</td>
</tr>
<tr>
<td>environment</td>
<td>environment (e.g. DEV)</td>
</tr>
<tr>
<td>git_commit</td>
<td>the commit that was built</td>
</tr>
<tr>
<td>error</td>
<td>the error</td>
</tr>
<tr>
<td>msg</td>
<td>the log message</td>
</tr>
<tr>
<td>level</td>
<td>the log level</td>
</tr>
<tr>
<td>unit</td>
<td>the unit that logs (e.g. config, influx, ...)</td>
</tr>
<tr>
<td>service</td>
<td>the service that logs (e.g. health)</td>
</tr>
<tr>
<td>middleware</td>
<td>the middleware that logs</td>
</tr>
<tr>
<td>module</td>
<td>the module that logs</td>
</tr>
<tr>
<td>transport</td>
<td>the transport layer (i.e. http or grpc)</td>
</tr>
<tr>
<td>took</td>
<td>the response time</td>
</tr>
</tbody>
</table>
<h2 id="redis">Redis</h2>
<p>By default the Redis configuration is empty, which mean we do not use Redis. The loggers only log to stdout. 
If the Redis configuration keys are present in the configuration file, the logs are duplicated to stdout and Redis.
Note that the redis logs are formatted in <a href="https://www.elastic.co/products/logstash" target="_blank">Logstash</a> format.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>redis-host-port</td>
<td>Redis server host:port</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>redis-password</td>
<td>Redis password</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>redis-database</td>
<td>Redis database</td>
<td>0</td>
</tr>
<tr>
<td>redis-write-interval-ms</td>
<td>Write interval in milliseconds</td>
<td>1000</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="testing.html" class="navigation navigation-prev " aria-label="Previous page: Testing with mocks">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="instrumenting.html" class="navigation navigation-next " aria-label="Next page: Instrumenting">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Logging","level":"1.4.4","depth":2,"next":{"title":"Instrumenting","level":"1.4.5","depth":2,"path":"chapter-godevel/instrumenting.md","ref":"chapter-godevel/instrumenting.md","articles":[]},"previous":{"title":"Testing with mocks","level":"1.4.3","depth":2,"path":"chapter-godevel/testing.md","ref":"chapter-godevel/testing.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["richquotes"],"pluginsConfig":{"richquotes":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"chapter-godevel/logging.md","mtime":"2018-03-21T15:18:31.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-04-03T13:03:13.889Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

